// Colormaps extracted from hopalongv124.html
// Returns RGB arrays [r,g,b] with components 0-255.

function clamp01(x){ return x < 0 ? 0 : (x > 1 ? 1 : x); }
function lerp(a,b,t){ return a + (b-a)*t; }
function lerp3(c1,c2,t){ return [lerp(c1[0],c2[0],t), lerp(c1[1],c2[1],t), lerp(c1[2],c2[2],t)]; }
function fromStops(stops, t){
  t = clamp01(t);
  for (let i=0; i<stops.length-1; i++){
    const a = stops[i], b = stops[i+1];
    if (t >= a[0] && t <= b[0]){
      const u = (t - a[0]) / (b[0] - a[0] || 1);
      return lerp3(a[1], b[1], u);
    }
  }
  return stops[stops.length-1][1];
}

export const ColorMaps = {
"Turbo": (t) => fromStops([
      [0.00,[48,18,59]],[0.10,[50,44,125]],[0.20,[32,96,189]],[0.30,[41,158,179]],
      [0.40,[93,201,99]],[0.50,[177,222,44]],[0.60,[236,199,24]],[0.70,[250,144,25]],
      [0.80,[243,85,38]],[0.90,[206,41,57]],[1.00,[122,4,3]]
    ], t),
    "Viridis": (t) => fromStops([[0,[68,1,84]],[.25,[59,82,139]],[.5,[33,145,140]],[.75,[94,201,98]],[1,[253,231,37]]], t),
    "Plasma": (t) => fromStops([[0,[13,8,135]],[.25,[126,3,167]],[.5,[203,71,119]],[.75,[248,149,64]],[1,[240,249,33]]], t),
    "Inferno": (t) => fromStops([[0,[0,0,4]],[.25,[87,15,109]],[.5,[187,55,84]],[.75,[249,142,8]],[1,[252,255,164]]], t),
    "Magma": (t) => fromStops([[0,[0,0,4]],[.25,[78,18,123]],[.5,[182,54,121]],[.75,[251,136,97]],[1,[252,253,191]]], t),
    "Gray": (t) => { const v = Math.round(255*clamp01(t)); return [v,v,v]; },
    "Rainbow": (t) => {
      t = clamp01(t);
      const h = (1 - t) * 240;
      const c = 1, hp = h/60, x = c*(1-Math.abs((hp%2)-1));
      let r=0,g=0,b=0;
      if (hp<1){ r=c; g=x; } else if (hp<2){ r=x; g=c; }
      else if (hp<3){ g=c; b=x; } else if (hp<4){ g=x; b=c; }
      else if (hp<5){ r=x; b=c; } else { r=c; b=x; }
      return [Math.round(r*255),Math.round(g*255),Math.round(b*255)];
    },
    "Heat": (t) => fromStops([[0,[0,0,0]],[.33,[180,0,0]],[.66,[255,160,0]],[1,[255,255,255]]], t),
    "Ocean": (t) => fromStops([[0,[0,0,0]],[.25,[0,20,70]],[.5,[0,90,160]],[.75,[40,180,220]],[1,[220,250,255]]], t)
  
    ,
    "H&E": (t) => fromStops([[0,[20,10,30]],[.20,[60,40,120]],[.45,[190,90,180]],[.70,[245,170,210]],[1,[255,245,250]]], t),
    "Giemsa": (t) => fromStops([[0,[10,8,30]],[.25,[30,60,140]],[.50,[80,140,170]],[.75,[210,180,120]],[1,[250,245,220]]], t),
    "Gram": (t) => fromStops([[0,[15,10,20]],[.30,[90,40,140]],[.55,[160,90,210]],[.78,[210,160,80]],[1,[245,245,235]]], t),
    "PAS": (t) => fromStops([[0,[15,8,8]],[.28,[120,30,70]],[.55,[220,120,160]],[.78,[245,210,120]],[1,[255,250,235]]], t),
    "Trichrome": (t) => fromStops([[0,[5,20,30]],[.25,[10,70,120]],[.50,[40,140,160]],[.75,[170,190,120]],[1,[245,245,230]]], t),
    "DAB": (t) => fromStops([[0,[5,5,5]],[.25,[60,40,20]],[.50,[120,80,40]],[.75,[190,150,90]],[1,[250,245,235]]], t),
    "Fluorescein": (t) => fromStops([[0,[0,0,0]],[.15,[0,30,10]],[.40,[0,120,40]],[.70,[60,220,90]],[1,[230,255,240]]], t),
    "Toluidine": (t) => fromStops([[0,[5,5,20]],[.25,[30,30,110]],[.50,[80,90,190]],[.75,[150,170,220]],[1,[245,250,255]]], t),
    "Safranin+FG": (t) => fromStops([[0,[10,5,5]],[.25,[160,40,60]],[.50,[220,120,90]],[.72,[80,160,90]],[1,[235,250,235]]], t),
    "Sepia": (t) => fromStops([[0,[0,0,0]],[.25,[70,50,30]],[.50,[130,100,60]],[.75,[200,175,130]],[1,[250,245,235]]], t)
};

export const ColorMapNames = Object.keys(ColorMaps);

export function sampleColorMap(name, t){
  const fn = ColorMaps[name] || ColorMaps[ColorMapNames[0]];
  return fn ? fn(t) : [255,255,255];
}
